<!DOCTYPE html>
<html>
<head>
<title>Playlist Generator</title>
<meta charset="utf-8" />
				<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
				<meta name="format-detection" content="telephone=no">
				<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
				<link type="text/css" rel="StyleSheet" href="http://www.days4god.com/_st/my.css" />
				<link rel="stylesheet" type="text/css" media="all" href="http://www.days4god.com/css/bootstrap.min.css" />
				<link rel="stylesheet" href="http://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
				<link rel="stylesheet" href="http://www.days4god.com/css/main.css">
				<link rel="stylesheet" href="http://www.days4god.com/css/responsive.css">
				<link rel="stylesheet" href="http://www.days4god.com/css/css.css">
				<link rel="stylesheet" href="http://www.days4god.com/css/skin.css">
</head>
<body>
<header id="top-bar" class="navbar-fixed-top dark">
<div class="container">
<div class="navbar-header">
<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
<span class="sr-only"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<div class="navbar-brand">
<a href="/">
<img src="http://www.days4god.com/logo.svg">
</a>
</div>
</div>
<nav class="collapse navbar-collapse navbar-right" role="navigation">
<div class="main-menu">

<div id="uNMenuDiv1" class="uMenuV"><ul class="uMenuRoot">
<li><a href="/"><span>Главная страница</span></a></li>

</ul></div>
</div></nav>
</div>
</header>
<div class="wrapperbod">
<section class="global-page-header music">
 <div class="container">
 <div class="row">
<div class="progress" style="position: relative;margin: 2px 15px;top: 0;height: 5px;"><div class="progress-bar" id="executionProgress" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"></div></div>
 <div class="col-md-10">
 <div class="block">
 <h2>Generator</h2>
 <ol class="breadcrumb">
 <li><a href="http://days4god.com/"><i class="ion-ios-home-outline"></i> Главная</a></li>
 <li><a href="/playergeneartor101.html">Playlist Generator</a></li>
 </ol>
 </div>
 </div>
 <div class="col-md-2" style="padding: 5px 15px;">
	 <input type="button" value="Create Playlist Page" onclick="createFile();" class="pull-right">
 </div>
 </div>
 </div>
 </section>
<section style="background-color:#fff;border-top:2px solid #f1f1f1;">
		<div class="container">
			<div class="row" style="display:none">
				<input placeholder="URL retrieval..." id="url-path" style="min-width:100%;">
			</div>
			<div class="row">
				<div id="htmlplayground"></div>
				<ul id="links" style="display:none;"></ul>
				<audio id="audiotrack"></audio>
				<div class="col-md-12" style="padding: 20px 15px;">
					<input placeholder="Artist..." id="artist">
					<input placeholder="Album..." id="album">
					<input placeholder="Artwork..." id="artwork">
				</div>
				<div class="col-md-6">
					<textarea placeholder="HTML Input..." cols="120" rows="30" id="input"></textarea>
				</div>
				<div class="col-md-6">
					<textarea placeholder="HTML Output..." cols="120" rows="30" id="output" readonly="readonly"></textarea>
				</div>
			</div>
	</div>
</section>
</div>
<style>
textarea {
    resize: none;
}
</style>
<script>
var firsttime = true;
// Global variables to be used throughout multiple functions
var artist, album, artwork, tracks;
var links = [];
var titles= [];
var duration = [];
var htmlplayground = document.getElementById("htmlplayground");
var progress;
function createFile() {
  // remove HTML code/appended if it is the second time and so on.
  if(firsttime == false) {
    console.log("Clean up in Progress.");
    document.getElementById("links").innerHTML = "";
		document.getElementById("htmlplayground").innerHTML = "";
		console.log("Clearing Variables");
		artist ="";
		album = "";
		artwork = "";
		titles = [];
		links = [];
		duration = [];
		tracks = "";
		n = 0;
		progress = 0;
		document.getElementById("output").value = "";
		//console.clear();
	}
  firsttime = false;
	// Get Data from input
  artist = document.getElementById("artist").value;
  album = document.getElementById("album").value;
  artwork = document.getElementById("artwork").value;
  input = document.getElementById("input").value;
	// Replace content in that element w/ user input
  document.getElementById("htmlplayground").innerHTML = input;
	// Get title of the track based on the text next to the link text
	console.log("Gathering track titles and links.");
	for (i=0; i < htmlplayground.childNodes.length; i++) {
		document.getElementById("htmlplayground").innerHTML = input;
		if(htmlplayground.childNodes[i].nodeName == "A") {
			titles.push(htmlplayground.childNodes[i].previousSibling.nodeValue); //Push each Title to the array
			links.push(htmlplayground.childNodes[i].href); // Like the titles, except for links
		}
	}
	tracks = links.length;
	// Append HTML "<audio>" player
	console.log("Appending Tracks...");
	appendAudio(0);
}

function appendAudio(n) {
	if(n != tracks) { // recursive loop
		htmlplayground.innerHTML = "<audio id=\"audiotrack" + n +"\" src=\""+ links[n] +"\" autoplay muted></audio>";
		// get Duration of the track appended above
		console.log("Getting Duration for\n",n+1, ". ",titles[n]);
		getDuration(n);
	} else {
		console.log("Process Complete.")
		checkdurationLength();
		// Clean up HTML after function has done it's job
		// $("#htmlplayground").html();
	}
}
function getDuration(n) {
	document.getElementById("audiotrack" + n).oncanplaythrough = function () {
		// declare elment in a variable
		var myAudio = document.getElementById("audiotrack" + n); //Object Identifier
		// parse the duration and append it into the array
		duration[n] = parseInt(myAudio.duration.toFixed()); // Get duration of the Track and Round it and convert it into a integer
		console.log("Duration Set.");
		getDurationLoop(n);
	}
	executionProgress(n);
}
function getDurationLoop(n) {
	if(duration[n] == undefined) {
		getDuration(n);
	} else {
		//console.clear();
		n++; // check before getting distracted
		appendAudio(n);
	}
}
function checkdurationLength() {
	if(duration.length == tracks) {
		createPlayer();
	} else {
		console.log("Extra values in Duration");
	}
}
function createPlayer() {
	executionProgress(100);
	htmlplayground.innerHTML = "";
	console.log("Creating Player for", artist , "-", album);
	output = "<div style=\"margin:12px auto;\" align=\"center\">\n\t<div id=\"amazingaudioplayer-1\" style=\"display:block;position:relative;width:100%;height:auto;margin:0px auto 0px;\">\n\t\t<ul class=\"amazingaudioplayer-audios\" style=\"display:none;\">\n";
	for(n = 0; n < links.length; n++) {
		output += "\t\t\t<li data-artist=\""+artist+ //insert value into data-type
							"\" data-title=\"" + titles[n] + //insert value into data-type
							"\" data-album=\""+album+ //insert value into data-type
							"\" data-info=\"\" data-image=\""+artwork+ //insert value into data-type
							"\" data-duration=\""+duration[n]+ //insert value into data-type
							"\">\n\t\t\t\t<div class=\"amazingaudioplayer-source\" data-src=\"" + links[n]+ //insert value into data-type
							" \" data-type=\"audio/mpeg\"></div>\n\t\t\t</li>\n";
	}
	output += "\t\t</ul>\n\t</div>\n</div>";
	document.getElementById("output").value = output;
	console.log("Player has been created successfully!");
}
function executionProgress(percent) {
	progress = percent;
	document.getElementById('executionProgress').style.width = progress +"%";
}
</script>
<footer id="footer" style="background-color:#333;">
<div class="container">
<div class="row align-left">

 <!-- Widget -->
 <div class="col-sm-6 col-md-3">
 <div class="widget">

 <h5 class="widget-title font-alt">Медиа</h5>

 <div class="widget-body">
<ul class="arrow">
 <li>
 <a href="/audio/music" title="">Музыка</a>
 </li>
 <li>
 <a href="/video" title="">Видео</a>
 </li>
 <li>
 <a href="/audio/sermons" title="">Проповедь</a>
 </li>
 <li>
 <a href="/audio/testimonies" title="">Свидетельства</a>
 </li>
 <li>
 <a href="/audio/bible" title="">Библия</a>
 </li>
 </ul>
 </div>

 </div>
 </div>


 <div class="col-sm-6 col-md-3">
 <div class="widget">

 <h5 class="widget-title font-alt">Общое</h5>

 <div class="widget-body">
 <ul class="arrow">
 <li>
 <a href="/blog/1-0-8" title="">Для Молодежи</a>
 </li>
 <li>
 <a href="/publ/29" title="">Кухня Марфы</a>
 </li>
 <li>
 <a href="/publ/2" title="">Стихи</a>
 </li>
 <li>
 <a href="/publ/56" title="">Пожелания</a>
 </li>
 <li>
 <a href="/forum" title="">Форум</a>
 </li>
 </ul>
 </div>

 </div>
 </div>

 <div class="col-sm-6 col-md-3">
<div class="widget">
<h5 class="widget-title font-alt">О нас</h5>
<div class="widget-body">
 <ul class="arrow">
 <li>
 <a href="/ourteam" title="">Наша Команда</a>
 </li>
 <li>
 <a href="/index/0-34" title="">Наши Баннеры</a>
 </li>
 <li>
 <a href="/gb" title="">Нам Пишут</a>
 </li>
 <li>
 <a href="/faq" title="">Вопрос/Ответ</a>
 </li>
 <li>
 <a href="#" title="">Пользовательское соглашение</a>
 </li>
 </ul>
</div>
</div>
</div>

 <div class="col-sm-6 col-md-3">
 <div class="widget">

 <h5 class="widget-title font-alt">Служба поддержки</h5>

 <div class="widget-body">
 <ul class="arrow">
 <li>
 <a href="skype:www.days4god.com" title="">Skype: www.Days4GOD.com</a>
 </li>
 <li>
 <a href="mailto:info@days4god.com" title="">E-mail: info@Days4GOD.com</a>
 </li>
 <li>
 <a href="/index/0-11" title="">Обратная связь</a>
 </li>
 <li>
 <a href="tel:19168992832" title="">Тел: +1 ( 916 ) 899-28-32</a>
 </li>
 </ul>
 </div>

 </div>
 </div>

</div>
<hr>
<div class="col-md-10">
 <p class="copyright">При копировании материалов, ссылка на сайт обяательна. Запрещено удаление watermark с изображений.| Days4GOD.com © 2007 - 2016
</p>
</div>
<div class="col-md-2">
<!-- Social Media -->
<ul class="social">
<li><a href="https://www.facebook.com/Дни-Для-Богасом-159428154068174/" class="Facebook"><i class="ion-social-facebook"></i></a></li>
</ul>
</div>
</div>
</footer>
</body>
</html>
